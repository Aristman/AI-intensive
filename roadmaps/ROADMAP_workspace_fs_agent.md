# ROADMAP: Workspace FS Agent

Цель: реализовать агента для работы с файловой системой workspace (безопасная песочница внутри корня проекта). Основные функции: список файлов/папок, чтение файла, запись/создание файла и папок.

## Чек‑лист задач

- [x] Формализовать API агента
  - [x] Описать команды агента: `list(path)`, `read(path)`, `write(path, content, createDirs=false, overwrite=false)`, `delete(path, recursive=false)`
  - [x] Определить формат DTO: запросы/ответы, ошибки (ENOENT, EACCES, EISDIR, Validation)
  - [x] Правила безопасности путей: нормализация, запрет выхода за пределы корня, разрешённые корни (по умолчанию весь репозиторий)

- [x] Базовая реализация сервисного слоя (FileSystemService)
  - [x] Методы: `list`, `readFile`, `writeFile`, `deletePath`, `ensureInsideRoot`
  - [x] Нормализация путей и защита от path traversal (`..`, абсолютные пути, симлинки — по возможности)
  - [x] Юнит‑тесты сервиса: валидные кейсы, ошибки, граничные случаи

- [x] Реализация WorkspaceFsAgent (на базе `sample_app/lib/agents/agent_interface.dart`)
  - [x] Интеграция с IAgent / IToolingAgent: поддержка `AgentRequest/AgentResponse`, события
  - [x] Команды: `fs_list`, `fs_read`, `fs_write`, `fs_delete`
  - [x] Логи и человеко‑читаемые сообщения об ошибках

- [x] Тесты
  - [x] Юнит‑тесты агента (успех/ошибки, нормализация путей, операции удаления)

- [x] Документация
  - [x] Добавить `docs/workspace_fs_agent.md` (архитектура, API, примеры)
  - [x] Обновить root `README.md` (ссылка) и `roadmaps/README` при необходимости

- [x] Завершение
  - [x] Прогнать `flutter analyze` и `flutter test`
  - [x] Отметить чекбоксы выполненными, приложить скриншоты/логи при необходимости

## Нефункциональные требования

- Безопасность: жёсткая песочница — никакие операции не должны выходить за пределы корня workspace
- Кроссплатформенность путей (Windows/Unix)
- UX: информативные ошибки, не блокирующий UI

## Согласованные решения

- Имя агента и путь реализации: `WorkspaceFsAgent` в `sample_app/lib/agents/workspace/workspace_fs_agent.dart` — согласовано
- Перезапись — только по явному флагу (`overwrite=false` по умолчанию)
- UI‑интеграции на данном этапе нет
- Удаление файлов/папок поддерживаем (включая флаг `recursive` для директорий)
