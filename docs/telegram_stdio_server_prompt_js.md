### Промпт для нейросети:

**Роль:** Ты — опытный JavaScript/TypeScript разработчик, специализирующийся на создании серверов Model Context Protocol (MCP) и интеграциях с Telegram API.

**Задача:** Создать с нуля MCP-сервер для работы с Telegram на современном JavaScript (ESM), строго следуя предоставленному техническому заданию и архитектуре.

**Расположение** проект создай в папке `mcp_servers/telegram_mcp_server`

**Техническое задание (ТЗ):**

Сервер должен реализовывать следующий функционал Telegram API:
1.  **Разрешение чатов:** Получение информации о чате по имени, ID или username.
2.  **Чтение истории:** Получение истории сообщений с поддержкой пагинации (лимит, смещение).
3.  **Отправка сообщений:** Отправка текстовых сообщений в указанные чаты.
4.  **Пересылка сообщений:** Пересылка сообщений между чатами.
5.  **Чтение сообщений:** Маркировка одного или нескольких сообщений как прочитанных.
6.  **Количество непрочитанных:** Получение общего количества непрочитанных сообщений.

**Архитектура и структура проекта:**
```
project-root/
├── src/
│   ├── index.js          # Точка входа, инициализация сервера
│   ├── handlers/
│   │   ├── resources.js  # Менеджер ресурсов (list/read)
│   │   └── tools.js      # Менеджер инструментов (list/call)
│   ├── config.js         # Конфигурация сервера
│   └── utils.js          # Вспомогательные утилиты
└── package.json
```

**Детальные инструкции по файлам:**

1.  **`src/config.js`:**
    *   Экспортируй объект конфигурации с полями `name` (например, "telegram-mcp-server") и `version` (например, "0.1.0").
    *   Настрой получение критически важных параметров (таких как `apiId`, `apiHash`, `phoneNumber` для Telegram Client) из переменных окружения (например, `process.env.TELEGRAM_API_ID`). Если они не найдены, логируй четкую ошибку в `stderr`.
    *   Добавь JSDoc комментарии.

2.  **`src/utils.js`:**
    *   Экспортируй вспомогательные функции.
    *   `setupTelegramClient`: Асинхронная функция для инициализации и аутентификации клиента Telegram MTProto. Должна обрабатывать код 2FA.
    *   `getInputEntity`: Асинхронная функция, которая принимает идентификатор чата (число, строку с юзернеймом или телефоном) и возвращает соответствующий объект `InputPeer`.
    *   Добавь функцию для логирования ошибок `logError(error)`, которая выводит подробности в `console.error`.

3.  **`src/handlers/resources.js`:**
    *   Реализуй `resources.list`: Пока что должен возвращать пустой массив `[]` или массив с ресурсами-плейсхолдерами (например, `[{ uri: 'telegram://chats' }]`).
    *   Реализуй `resources.read`: Должен принимать URI и возвращать содержимое. На данном этапе для любого URI можно возвращать ошибку `"Resource not found"` или текст-заглушку.
    *   Используй асинхронные функции. Оберни логику в `try/catch` и возвращай ошибки через `return { contents: { error: error.message } }`.

4.  **`src/handlers/tools.js`:**
    *   **Это ключевой файл.** Реализуй `tools.list`: Он должен возвращать массив объектов-инструментов, соответствующих 6 пунктам ТЗ. Для каждого инструмента обязательно опиши `name` и четкую `inputSchema` в формате JSON Schema, определяющую параметры (например, для "отправки сообщения" схема должна требовать `chatId` и `text`).
    *   Реализуй `tools.call`: Асинхронная функция, которая обрабатывает вызов инструмента по его имени.
        *   Используй `switch` или `if/else` для маршрутизации вызовов на основе `toolName`.
        *   В каждой ветке вызывай соответствующую функцию логики, используя параметры из `parameters`.
        *   Для взаимодействия с Telegram используй функции из `src/utils.js`.
        *   ВСЯ логика работы с Telegram API должна быть здесь или вынесена в `utils.js`.
        *   **ВСЕГДА обрабатывай ошибки с помощью `try/catch`**. В блоке `catch` логируй ошибку и возвращай объект с полем `error`, содержащее понятное сообщение.
        *   При успешном выполнении возвращай результат в виде строки (можно использовать `JSON.stringify` для объектов).

5.  **`src/index.js`:**
    *   Импортируй необходимые модули: `@modelcontextprotocol/sdk`, `./config.js`, `./handlers/resources.js`, `./handlers/tools.js`.
    *   Создай экземпляр сервера MCP с помощью `new Server()`.
    *   Зарегистрируй обработчики ресурсов и инструментов через `server.setRequestHandler(...)`.
    *   Инициализируй сервер с транспортом `StdioTransport()`.
    *   Реализуй корректную обработку сигналов завершения работы (например, `SIGINT`) для graceful shutdown, убедившись, что клиент Telegram корректно отключается.

**Общие требования к коду:**
*   **Стиль:** Используй современный JavaScript (ESM) с `import/export`.
*   **Асинхронность:** Весь код, работающий с сетью (Telegram API) или файловой системой, должен быть асинхронным (`async/await`).
*   **Комментарии:** Добавь четкие `// TODO:` комментарии в тех местах, где требуется доработка или реализация сложной логики (например, `// TODO: Implement pagination for history` внутри инструмента чтения истории).
*   **Логирование:** Все ошибки и отладочная информация (кроме результата работы инструментов) должны выводиться в `stderr` через `console.error`.
*   **Заглушки:** Если реализация какой-то части требует длительной разработки (например, пагинация), сначала создай работающую заглушку, чтобы сервер запускался, и пометь ее `TODO`-комментарием.

**Начало работы:**
Перед генерацией кода создай в корне проекта файл `Roadmap.md` и запиши в него подробный пошаговый план на основе этого ТЗ и промпта. В процессе работы отмечай выполненные шаги.

---

**Начни выполнение задачи.** Сгенерируй полный исходный код для каждого из указанных файлов, строго следуя инструкциям.